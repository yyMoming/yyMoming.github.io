
<!DOCTYPE html>
<html lang="ch-zh ">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>yyMoming || 关键字：const</title>
    <meta name="author" content="Moming">
    <meta name="description" content="一个爱吃的小羊羊 ">
    <meta name="keywords" content=" ">
    <link rel="icon" href="/images/1.jpg">
    <link rel="stylesheet" href="/css/antd.min.css">
    
    <link rel="stylesheet" href="/css/maiden-theme.css">
    
    <script src="/js/vue.js"></script>
    <script src="/js/antd.min.js"></script>
<meta name="generator" content="Hexo 5.4.0"></head>

<body>

    <div id="loading"
        style="height: 100vh; width: 100%; position: fixed;display: flex;z-index: 200; justify-content: space-between;">
        <div id="loadleft" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div id="loadright" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div
            style="position: fixed; height: 100vh; width: 100%;display: flex;justify-content: center;align-items: center;">
            <div id="loadcontent"
                style="width:400px;height:400px;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px#a3ddfb; text-align:center;opacity:1;transition:opacity 0.3s ease-out;">
                <div>
                    <h2>LOADING...</h2>
                    <p>加载过慢请开启缓存(浏览器默认开启)</p>
                    <div>
                        <img src="/dancingkitty.gif" alt="loading">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="layout">
        <transition name="into">
            <div v-show="show_page" style="display: none;">
                <div id="menu_show">
                     
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">yyMoming</span>
        </a>
        
        <a href="/">
            <span>
                <a-icon type="home" theme="filled" />
            </span>
            <span>home</span>
        </a>
        
        <a href="/about/">
            <span>
                <a-icon type="idcard" theme="filled" />
            </span>
            <span>about</span>
        </a>
        
        <a href="/archives/">
            <span>
                <a-icon type="folder" theme="filled" />
            </span>
            <span>archives</span>
        </a>
        
        <a href="/categories/">
            <span>
                <a-icon type="book" theme="filled" />
            </span>
            <span>categories</span>
        </a>
        
        <a href="/tags/">
            <span>
                <a-icon type="tags" theme="filled" />
            </span>
            <span>tags</span>
        </a>
        
    </div>

    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div :class="'title'" @click="menu_show=!menu_show">
            <span style="margin-right: 10px;">
                <a-icon type="appstore" theme="filled" />
            </span>
            <span>yyMoming</span>
        </div>
        <div class="items" v-show="menu_show">
            
            <a href="/">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="home" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">home</div>
                </div>
            </a>
            
            <a href="/about/">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="idcard" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">about</div>
                </div>
            </a>
            
            <a href="/archives/">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="folder" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">archives</div>
                </div>
            </a>
            
            <a href="/categories/">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="book" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">categories</div>
                </div>
            </a>
            
            <a href="/tags/">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="tags" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">tags</div>
                </div>
            </a>
            
        </div>
        <div class="curtain" v-show="menu_show"></div>
    </div>

</nav>
                </div>

                <div id="main">
                     
<link rel="stylesheet" href="/css/post-body.css">
<div class="article">
    <div>
        <h1>关键字：const </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2021/5/21
        </span>

        
        <span class="category">
            <a href="/categories/Cpp基础">
                <span class="icon">
                    <a-icon type="book" theme="filled" />
                </span>
                Cpp基础
            </a>
        </span>
        

        

        <span class="tags">
            <span class="icon">
                <a-icon type="tags" theme="filled" />
            </span>
            
            <span class="tag">
                
                <a href="/tags/c++" style=color:#1bccbc>
                    c++
                </a>
            </span>
            
        </span>
        
    </div>

    <div class="content" v-pre>
        <h2 id="关键字：const"><a href="#关键字：const" class="headerlink" title="关键字：const"></a>关键字：const</h2><hr>
<ol>
<li><h5 id="const-含义"><a href="#const-含义" class="headerlink" title="const 含义"></a>const 含义</h5><h6 id="将一个变量变成常量，使用类型修饰符-const-说明的变量或对象的值是不能被更新的。"><a href="#将一个变量变成常量，使用类型修饰符-const-说明的变量或对象的值是不能被更新的。" class="headerlink" title="将一个变量变成常量，使用类型修饰符 **const **说明的变量或对象的值是不能被更新的。"></a>将一个变量变成常量，使用类型修饰符 **const **说明的变量或对象的值是不能被更新的。</h6><p>实际上，被 <strong>const</strong> 修饰的值，只会在编译器保证其不被修改。程序运行时，通过特定方法是可以修改值的。</p>
<span id="more"></span></li>
<li><h5 id="const-作用"><a href="#const-作用" class="headerlink" title="const 作用"></a>const 作用</h5><h6 id="（1）定义常量：定义常量后不能修改，且必须初始化"><a href="#（1）定义常量：定义常量后不能修改，且必须初始化" class="headerlink" title="（1）定义常量：定义常量后不能修改，且必须初始化"></a>（1）定义常量：定义常量后不能修改，且必须初始化</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> a = <span class="number">100</span>; <span class="comment">// 例1</span></span><br><span class="line"><span class="comment">// 或者:</span></span><br><span class="line"><span class="keyword">int</span> a = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> b = a; <span class="comment">//正确，例2</span></span><br><span class="line">b = <span class="number">20</span>; <span class="comment">//错误,b不可以再被改变</span></span><br></pre></td></tr></table></figure>

<p>☆ 对于例1，在编译时，编译器发现 $a$ 是<strong>真常量</strong>，所以会把后面使用到 $a$ 的地方直接进行替换，起到了 <strong>$#define$</strong> 的作用。</p>
<h6 id="（2）检查类型"><a href="#（2）检查类型" class="headerlink" title="（2）检查类型"></a>（2）检查类型</h6><p><strong>const</strong> 常量与被 <strong>$#define$</strong> 宏定义常量的区别：</p>
<ul>
<li><strong>const</strong> 常量具有类型，编译器可以进行安全检查</li>
<li><strong>$#define$</strong> 宏定义没有数据类型，只是简单的字符串替换，不能进行安全检查</li>
<li><strong>const</strong> 定义的变量只有类型为整数或枚举，且以常量表达式（就是表达式里面只有常量的式子）初始化时才能作为常量表达式，其他情况下知识一个 <strong>const</strong> 限定的变量，不一定是常量。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS: 通常来说，尽量以 const，enum，inline 替换 #define。  ————《Effective C++》</span><br><span class="line">PS：常量表达式是指值不会改变并且在编译过程就能得到计算结果的表达式。C++11 后允许将变量声明为 constexpr 类型以便由编译器来验证变量是否是一个常量表达式，声明为 constexpr 的变量一定是一个常量，必须用常量表达式初始化。</span><br></pre></td></tr></table></figure>



<h6 id="（3）-防止被程序修改，增强程序的健壮性"><a href="#（3）-防止被程序修改，增强程序的健壮性" class="headerlink" title="（3） 防止被程序修改，增强程序的健壮性"></a>（3） 防止被程序修改，增强程序的健壮性</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    i = <span class="number">100</span>; <span class="comment">//错误，const常量不能被改变</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="（4）节省空间，避免不必要的内存分配"><a href="#（4）节省空间，避免不必要的内存分配" class="headerlink" title="（4）节省空间，避免不必要的内存分配"></a>（4）节省空间，避免不必要的内存分配</h6><p><strong>const</strong> 定义常量从汇编角度来看，只是给出了对应的内存地址，而不像是 <strong>$#define$</strong> 给出的是立即数（通常把在<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%AB%8B%E5%8D%B3%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F/6686429">立即寻址方式</a>指令中给出的数称为立即数）。所以 const 定义的常量在程序运行过程中只有一份拷贝，而  <strong>$#define$</strong> 定义的常量在内存中有若干个拷贝。</p>
</li>
<li><h5 id="const-对象默认为文件局部变量"><a href="#const-对象默认为文件局部变量" class="headerlink" title="const 对象默认为文件局部变量"></a>const 对象默认为文件局部变量</h5><p>**<font color="red">Note： </font>**非 <strong>const</strong> 变量默认为 $extern$。要使 <strong>const</strong> 变量能够在其他文件中被访问，必须在文件中显式地指定为 $extern$。</p>
<h6 id="1-非-const-变量在不同文件之间的访问"><a href="#1-非-const-变量在不同文件之间的访问" class="headerlink" title="(1) 非 const 变量在不同文件之间的访问"></a>(1) 非 const 变量在不同文件之间的访问</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file1.cpp</span></span><br><span class="line"><span class="keyword">int</span> ext;</span><br><span class="line"><span class="comment">// file2.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;file1.cpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> ext;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cout &lt;&lt; ext &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="2-const-变量在不同文件之间访问"><a href="#2-const-变量在不同文件之间访问" class="headerlink" title="(2) const 变量在不同文件之间访问"></a>(2) const 变量在不同文件之间访问</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file1.cpp</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> ext = <span class="number">100</span>; <span class="comment">// extern const int ext = 100;也可以</span></span><br><span class="line"><span class="comment">// file2.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;file1.cpp&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">int</span> ext;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cout &lt;&lt; ext &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 file1 中，<strong>const</strong> 常量必须要初始化，可以使用 $extern$ ，也可以不使用。而如果 file1 中只是普通变量，则不能使用  $extern$，可以不初始化（也可以初始化）。</p>
</li>
<li><h5 id="指针与-const"><a href="#指针与-const" class="headerlink" title="指针与 const"></a>指针与 const</h5><h6 id="1-指向常量的指针"><a href="#1-指向常量的指针" class="headerlink" title="(1) 指向常量的指针"></a>(1) 指向常量的指针</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> *a; <span class="comment">// 可以不被初始化，指针a不是常量，但*a即a指向的对象是常量</span></span><br><span class="line"><span class="keyword">int</span> b = <span class="number">20</span>;</span><br><span class="line">a = &amp;b; <span class="comment">//正确</span></span><br><span class="line">*a = <span class="number">20</span>; <span class="comment">//错误，*a是常量，不可更改，尽管原来b不是const常量</span></span><br></pre></td></tr></table></figure>

<p><font color='green'>int</font> <font color='purple'>const</font> <font color='green'>*</font>a;</p>
<p>其中 a 与上述代码 <font color='green'>const</font> <font color='purple'>int</font> <font color='green'>*</font>a; 中的a一致。</p>
<h6 id="2-指针常量：必须初始化，且指针的值不能被修改，但指针指向的对象可以被修改"><a href="#2-指针常量：必须初始化，且指针的值不能被修改，但指针指向的对象可以被修改" class="headerlink" title="(2) 指针常量：必须初始化，且指针的值不能被修改，但指针指向的对象可以被修改"></a>(2) 指针常量：必须初始化，且指针的值不能被修改，但指针指向的对象可以被修改</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> b = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> * <span class="keyword">const</span> a = &amp;b; <span class="comment">// 必须被初始化</span></span><br><span class="line"><span class="keyword">int</span> c = <span class="number">200</span>;</span><br><span class="line">a = &amp;c; <span class="comment">// 错误，指针常量不可以被修改</span></span><br><span class="line">*a = <span class="number">200</span>; <span class="comment">// 正确，常量指针指向的对象不是const常量</span></span><br></pre></td></tr></table></figure>



<h6 id="3-指向-const-常量的指针常量"><a href="#3-指向-const-常量的指针常量" class="headerlink" title="(3) 指向 const 常量的指针常量"></a>(3) 指向 const 常量的指针常量</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> p = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> * <span class="keyword">const</span> ptr = &amp;p; <span class="comment">// ptr所指向的对象必须是常量，且 pre必须被初始化</span></span><br></pre></td></tr></table></figure></li>
<li><h5 id="函数中使用-const"><a href="#函数中使用-const" class="headerlink" title="函数中使用 const"></a>函数中使用 const</h5><h6 id="1-const-修饰函数返回值"><a href="#1-const-修饰函数返回值" class="headerlink" title="(1) const 修饰函数返回值"></a>(1) const 修饰函数返回值</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> <span class="keyword">int</span> <span class="title">func1</span><span class="params">()</span></span>; <span class="comment">// 函数返回值的副本变为const常量，接收的对象也应该为const 常量const int * func2(); // 指针指向内容不可变int* const func3(); // 指针不可变</span></span><br></pre></td></tr></table></figure>



<h6 id="2-const-修饰函数参数"><a href="#2-const-修饰函数参数" class="headerlink" title="(2) const 修饰函数参数"></a>(2) const 修饰函数参数</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> var)</span> <span class="comment">// var不可变，无意义void func2(int *const var) // 指针不可变，无意义void func3(const int *var) // 指针所指内容不可变void func4(const A&amp; a) // 使用引用增加效率，且防止修改</span></span></span><br></pre></td></tr></table></figure></li>
<li><h5 id="类中使用-const"><a href="#类中使用-const" class="headerlink" title="类中使用 const"></a>类中使用 const</h5><h6 id="1-const-修饰类成员函数"><a href="#1-const-修饰类成员函数" class="headerlink" title="(1) const 修饰类成员函数"></a>(1) const 修饰类成员函数</h6><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">people</span>&#123;</span>	<span class="keyword">private</span>:	 	string gender;	<span class="keyword">public</span>:		<span class="built_in">people</span>(<span class="keyword">int</span> a):<span class="built_in">age</span>(a);		<span class="keyword">const</span> <span class="keyword">int</span> age;  	<span class="function"><span class="keyword">void</span> <span class="title">get_age</span><span class="params">()</span> <span class="keyword">const</span></span>;   	<span class="function"><span class="keyword">void</span> <span class="title">set_gender</span><span class="params">(string g)</span></span>;&#125;<span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;  <span class="function">people <span class="title">p1</span><span class="params">(<span class="number">30</span>)</span></span>;  <span class="function"><span class="keyword">const</span> people <span class="title">p2</span><span class="params">(<span class="number">20</span>)</span></span>;  p1.<span class="built_in">get_age</span>(); <span class="comment">// 正确，不会改变对象成员信息  p1.set_gender(&quot;male&quot;); // 正确，非const成员函数可以改变对象成员信息  p2.set_gender(&quot;female&quot;); // 错误，const对象成员信息不能被改变&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>类中 const 成员变量只能通过初始化列表进行初始化</li>
<li>const 对象只能访问 const 成员函数，非 const 对象可以访问任何成员函数</li>
</ul>
</li>
<li><h5 id="const-与-static-结合"><a href="#const-与-static-结合" class="headerlink" title="const 与 static 结合"></a>const 与 static 结合</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> age; <span class="comment">// 类内声明const int age = 20; // 可以类内定义static const int age = 10; // C++11可以在类内初始化</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="tips-const-有地址-enum与-define没有地址"><a href="#tips-const-有地址-enum与-define没有地址" class="headerlink" title="tips: const 有地址, enum与#define没有地址"></a>tips: const 有地址, enum与#define没有地址</h3><p>1.const 定义的实际是一个变量 , const 只限定它不能被修改,所有变量都可在程序运行时获取其地址</p>
<p>2.enum 类型中的枚举项只是 enum 类型声明的一部分,它不是定义出来的变量,所以不能取地址</p>
<p>3.#define 出来的是宏,它是预处理的东西,预处理后的编译阶段已经不存在,所以也不可能获取宏的地址</p>

    </div>

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <div id="comment">
        <div id="gitalk-container">
        </div>
    </div>
    
</div>
                     
<footer id="footer">
    <div class="footer-wrap">
        <div>
            © 2021 - 2021 yyMoming
            <span class="footer-icon">
                <a-icon type="flag" theme="filled" /></span>
            @Moming
        </div>
        <div></div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a> & <a
                target="_blank" rel="noopener" href="https://github.com/korilin/hexo-theme-particle">Particle Theme</a></div>
        
    </div>

</footer>

<script src="/js/highlight.min.js"></script>
<script src="/js/particle.js"></script>
                </div>
            </div>
        </transition>
    </div>

    <script>
    new Vue({
        el: "#layout",
        data: {
            show_page: false,
            onload_menu: false,
            menu_show: false,
            card_top: 100
        },
        created: function () {
            var that = this
            window.onload = function () {
                that.show_page = true
                document.getElementById("loadcontent").style.opacity = 0
                setTimeout(function () {
                    document.getElementById("loadleft").style.width = 0
                    document.getElementById("loadright").style.width = 0
                }, 300)
                setTimeout(function () {
                    document.getElementById("loading").style = "display:none"
                }, 600)
            }
        },
        mounted: function () {
            var that = this
            window.addEventListener('scroll', function (e) {
                that.menu_show = false
            })
        },
        methods: {
            home_click: function () {
                window.scrollTo({
                    top: window.innerHeight - 80,
                    behavior: "smooth",
                });
            }
        }
    })
</script>

<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: '',
        clientSecret: '',
        repo: 'hexo-theme-particle',      // The repository of store comments,
        owner: 'korilin',
        admin: ['korilin'],
        language: 'zh-CN',
        id: location.pathname,      // Ensure uniqueness and length less than 50
        distractionFreeMode: true  // Facebook-like distraction free mode
    })
    gitalk.render('gitalk-container')
</script>

</body>

</html>